import { MigrationInterface, QueryRunner } from 'typeorm';

/**
 * –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏
 * 
 * –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç —Ç–µ–º—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã:
 * - –¢–µ–∫—É—â–∏–µ —Ç–µ–º—ã –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ (–∏–∑ –ö—É–ª—å—Ç—É—Ä–æ–ª–æ–≥–∏–∏) -> –≤ –ö—É–ª—å—Ç—É—Ä–æ–ª–æ–≥–∏—é
 * - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ–º—ã –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ (–∏–∑ seed-general-psychology-topics.ts) -> –≤ –ü—Å–∏—Ö–æ–ª–æ–≥–∏—é
 */

export class FixPsychologyTopics1764340000000
  implements MigrationInterface
{
  name = 'FixPsychologyTopics1764340000000';

  public async up(queryRunner: QueryRunner): Promise<void> {
    console.log('üîß –ò—Å–ø—Ä–∞–≤–ª—è—é —Ç–µ–º—ã –¥–ª—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã "–û–±—â–∞—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è"...');

    const PSYCHOLOGY_DISCIPLINE_ID = 'a9b8c7d6-2e5a-5351-4c6a-6d7e8f9a0b1c';
    const CULTUROLOGY_DISCIPLINE_ID = 'e7f6a5b4-0c3e-5139-2a4e-4b5c6d7e8f9a';

    // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ (–∏–∑ seed-general-psychology-topics.ts)
    const correctPsychologyTopics = [
      'aa319bad-30e9-4034-938f-93e4b3a434e6', // –ü—Ä–µ–¥–º–µ—Ç, –∑–∞–¥–∞—á–∏ –∏ –º–µ—Ç–æ–¥—ã –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏
      '53d2e29b-cee5-4f8f-9644-597f5c82117c', // –ò—Å—Ç–æ—Ä–∏—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏
      'cad3afa2-9398-49b8-8b93-457d09e3e53f', // –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø–∞—Ä–∞–¥–∏–≥–º—ã
      '1de782fc-91ca-4b53-b374-552afd14c630', // –ü—Å–∏—Ö–∏–∫–∞ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∑–≥–∞
      'b6e66a14-9b38-4a19-b712-59b421844b5f', // –ù–µ–π—Ä–æ—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã
      'ecf8226c-facc-45f7-9c6d-5e85e5a83fe5', // –ü—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
      '8498d03d-4de5-4065-b944-ed315b0df8df', // –û—â—É—â–µ–Ω–∏—è
      '2f3b105b-9855-4b84-b426-79766f274238', // –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ
      '31cb622f-df2f-4ade-aede-952e72cea538', // –í–Ω–∏–º–∞–Ω–∏–µ
      'd5109f58-752f-4810-bb86-b96d6ffeba35', // –ü–∞–º—è—Ç—å
      '33fe46dc-ea75-4f3c-ad94-470004b40e7b', // –ú—ã—à–ª–µ–Ω–∏–µ
      'aaf4ef4d-085e-4af7-bdf4-1943406cfe0e', // –†–µ—á—å –∏ —è–∑—ã–∫
      '535c5387-cfb9-4faf-b53c-3360490e7cbd', // –í–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
      '9489bdcb-62c0-47f8-95eb-542dfffc2836', // –≠–º–æ—Ü–∏–∏ –∏ —á—É–≤—Å—Ç–≤–∞
      '74b064ef-6cbf-4981-b6fc-e93df7bea881', // –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —Å—Ç—Ä–µ—Å—Å
      '136545b1-958e-4c79-842d-b435d33a0180', // –ú–æ—Ç–∏–≤–∞—Ü–∏—è –∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
      '8867afad-2369-4d3f-9ad2-3fcac51a9726', // –í–æ–ª—è
      '8e38f7b9-dee1-4ab6-adf5-49ef1d41a8cf', // –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
      '6c3df240-d93a-4071-b52d-74154762889b', // –û–±—â–µ–Ω–∏–µ
      '7c6c08f6-b550-419b-a17f-d79b3c968240', // –ò–Ω–¥–∏–≤–∏–¥, –ª–∏—á–Ω–æ—Å—Ç—å
      'd5ca2161-3b7a-4b8e-995a-0e4b87260f3e', // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
      '2adc4cf0-3cb4-4ceb-a383-067828e76e6f', // –ü—Å–∏—Ö–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–æ–¥—Ö–æ–¥—ã
      '8a5d6eaa-c9f2-41c3-935d-6052b9940cc7', // –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–Ω–æ-–º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ñ–µ—Ä–∞
      'ef380b77-c57a-41f9-920b-d471476a4740', // –°–∞–º–æ—Å–æ–∑–Ω–∞–Ω–∏–µ –∏ –Ø-–∫–æ–Ω—Ü–µ–ø—Ü–∏—è
      '3700a045-b39a-48c6-bacf-7f45d9d87bbe', // –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è
      'c639bac7-e108-44b8-9541-ddf1af7504e3', // –†–∞–∑–≤–∏—Ç–∏–µ –ø—Å–∏—Ö–∏–∫–∏
      'f9eff1b5-65a7-4039-be7a-7faabd33c5b3', // –ö—É–ª—å—Ç—É—Ä–Ω–æ-–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥
      'fbdff067-a06d-4236-9ba5-88d3119e8266', // –°–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏
      '761929d8-a0b5-41b9-a950-99ade48c937e', // –ù–æ—Ä–º–∞ –∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
      '452a0d4f-f3b7-4b9e-88ac-f6835fad93cb', // –û—Å–Ω–æ–≤—ã –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
      'cf12eb29-3d58-4b1a-90cb-09c3117b82b0', // –û—Å–Ω–æ–≤—ã –ø—Å–∏—Ö–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
      '8b4cf60d-98e5-498f-855f-8db9885a7774', // –ú–µ—Ç–æ–¥—ã –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
      'be600faf-6635-48a5-af4a-00799a1f52bd', // –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã
      'c07b74a3-d682-4853-8750-16ed0a390066', // –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –∫–∞–∫ –Ω–∞—É–∫–∞ —Å–µ–≥–æ–¥–Ω—è
      '0460a852-e877-4448-8c50-c9d4b8dbd433', // –≠—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏
    ];

    // 1. –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Ç–µ–∫—É—â–∏–µ —Ç–µ–º—ã –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ (–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∏–∑ –ö—É–ª—å—Ç—É—Ä–æ–ª–æ–≥–∏–∏) –≤ –ö—É–ª—å—Ç—É—Ä–æ–ª–æ–≥–∏—é
    await queryRunner.query(`
      UPDATE "topics"
      SET "DisciplineID" = '${CULTUROLOGY_DISCIPLINE_ID}'
      WHERE "DisciplineID" = '${PSYCHOLOGY_DISCIPLINE_ID}'
      AND "TopicID" NOT IN (${correctPsychologyTopics.map(id => `'${id}'`).join(', ')})
    `);

    // 2. –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ–º—ã –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ –≤ –ü—Å–∏—Ö–æ–ª–æ–≥–∏—é (–µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –≤ –¥—Ä—É–≥–∏—Ö –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ö)
    await queryRunner.query(`
      UPDATE "topics"
      SET "DisciplineID" = '${PSYCHOLOGY_DISCIPLINE_ID}'
      WHERE "TopicID" IN (${correctPsychologyTopics.map(id => `'${id}'`).join(', ')})
    `);

    console.log('‚úÖ –¢–µ–º—ã –¥–ª—è –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã');
  }

  public async down(queryRunner: QueryRunner): Promise<void> {
    console.log('üîÑ –û—Ç–∫–∞—Ç—ã–≤–∞—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º...');
    // –û—Ç–∫–∞—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –º—ã –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–º–µ—â–∞–µ–º —Ç–µ–º—ã
    console.log('‚úÖ –û—Ç–∫–∞—Ç –∑–∞–≤–µ—Ä—à–µ–Ω');
  }
}

